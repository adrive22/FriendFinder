<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="semantic/dist/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="survey.css">
    <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="semantic/dist/semantic.min.js"></script>
</head>

<body>


	<h1>Welcome to Friend Finder! Please fill out the form to find yo'self a fran.</h1>
<div class="input-container">
    <form class="ui form">
        <div class="field">
            <label>First Name</label>
            <input type="text" class="firstName" placeholder="First Name">
        </div>
        <div class="field">
            <label>Picture</label>
            <input type="url" class="pictureURL" placeholder="Picture URL">
        </div>
</div>

        <h2> Please choose between 1 and 5.  
        	<br> 1=strongly disagree | 5=strongly agree</h2>
    </form>
    <div class="form-container">
        <div class="ui grid">
            <div class="four wide column"></div>
            <div class="eight wide column">
                <div class="ui form">
                    <div class="field">
                        <div class="question 1">
                            <p>Do you like waking up early?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 2">
                            <p>Do you like going out at night?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 3">
                            <p>Do you like playing video games?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="3">4</option>
                                <option value="3">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 4">
                            <p>Do you like eating out?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 5">
                            <p>Do you drink?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 6">
                            <p>Do you like going to music shows?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 7">
                            <p>Do you like to read?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 8">
                            <p>Do you like science fiction?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 9">
                            <p>Do you watch the news?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <br>
                        <div class="question 10">
                            <p>Do you want to live in Austin forever?</p>
                            <select class="ui search dropdown">
                                <option class="selectionOption" value="">Please Choose</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <div class="four wide column"></div>
                    </div>
                </div>
                <button class="ui teal button" id="submitBtn" type="submit">
                    <i class="paper plane outline icon"></i> Submit
                </button>


<footer>
  
   <a href="/api/friends">
  API FriendList: </a>.</p>
</footer>





<div class="ui modal">
  <div class="header">Your Best Friend Match Is..</div>
  <div class="image content">
    <img class="image" src="">
    <div class="description">
      <p></p>
    </div>
  </div>
</div>










</body>
<script>
$('.ui.search.dropdown').dropdown()

$("#submitBtn").on("click", function() {

var name = $(".firstName").val();
console.log(name)
var picture = $(".pictureURL").val();
console.log(picture)

var input = $('.ui.search.dropdown').dropdown();
console.log(input);
var newFriend = {
    name: name,
    picture: picture,
    scores: []
}
for (i = 0; i < 10; i++) {
    if (isNaN(input[i].innerText)) {
        alert("Not all fields are completed");
    } else {
        newFriend.scores.push(input[i].innerText)
    }

}
console.log(newFriend.scores);






$.post("/api/friends", newFriend, function(data) {
    console.log(data);

})

var currentURL = window.location.origin;
$.ajax({ url: currentURL + "/api/friends", method: "GET" }).done(function(res) {


    var bestFriend="";
    var currentBest = 100;
    var differenceArray = [];


    for (i = 0; i < res.length - 1; i++) {
        for (j = 0; j < 10; j++) {
            var currentDifference = newFriend.scores[j] - res[i].scores[j];
            
            var difference = (Math.abs(currentDifference));
            console.log("absolute differece: " + difference);
        
    
            differenceArray.push(difference);
            console.log("differenceArray: " + differenceArray);
        }

          let sum = differenceArray.reduce((acc, val) => {
  		return acc + val;
			});
          console.log(sum);

          if(sum < currentBest){
						bestFriend = res[i].name;
						bestFriendPhoto=res[i].picture;
						currentBest = sum;
						differenceArray = [];
					}
					else{
						differenceArray =[];
					}
					console.log("best friend: " + bestFriend);
					console.log("bestfriendPhoto: " + bestFriendPhoto);
					
					
    				
        			var	modalImg = $(".image"); // hold reference to image in modal
        			 
        			 modalImg.attr("src", bestFriendPhoto);

        			var modalName = $(".description");
        			modalName.append(bestFriend);

        			 $('.ui.modal').modal('show');

        			function clearDropdown(){ setTimeout(function () { $('.ui.search.dropdown').dropdown('clear') },0) }
        			clearDropdown()

        			$(".firstName").val("");
        			$(".pictureURL").val("");
							
						
         
        			
					
        }
				
    })

})



</script>

</html>